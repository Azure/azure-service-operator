---
# ConfigMap containing identity details
apiVersion: v1
kind: ConfigMap
metadata:
  name: identity-settings
  namespace: default
data:
  clientId: "11111111-1111-1111-1111-111111111111"
  principalId: "22222222-2222-2222-2222-222222222222"
---
# ManagedCluster using config map references for identity profile
apiVersion: containerservice.azure.com/v1api20231001
kind: ManagedCluster
metadata:
  name: sample-managedcluster-with-configmap
  namespace: default
spec:
  location: westus3
  owner:
    name: aso-sample-rg
  dnsPrefix: aso-configmap-example
  agentPoolProfiles:
    - name: pool1
      count: 1
      vmSize: Standard_DS2_v2
      osType: Linux
      mode: System
  identity:
    type: UserAssigned
    userAssignedIdentities:
      - resourceReference:
          name: my-user-assigned-identity
  identityProfile:
    kubeletidentity:
      clientIdFromConfig:
        name: identity-settings
        key: clientId
      objectIdFromConfig:
        name: identity-settings
        key: principalId