# JSONAST Package

The `jsonast` package translates JSON schema and OpenAPI specifications into Go abstract syntax tree (AST) representations for use in the Azure Service Operator (ASO) code generator.

## Overview

The `jsonast` package serves as the bridge between JSON/OpenAPI schema definitions and Go source code. It analyzes schema structures and creates appropriate Go type representations, complete with validation constraints, documentation, and relationships.

**Schema abstraction** provides a unified interface for working with different schema formats. The package supports both OpenAPI (formerly Swagger) and JSON Schema formats through a common abstraction layer, allowing the code generator to work with either format seamlessly.

**Type resolution** is a core capability that transforms JSON schema constructs into their appropriate Go counterparts. For example, JSON string types with specific format or pattern constraints are mapped to appropriate validated Go string types, while JSON objects become Go structs.

**Schema parsing** handles complex schema relationships including references, allOf/oneOf/anyOf compositions, and inheritance. The package resolves these relationships into a coherent type system that preserves the semantics of the original schema.

## Testing

The jsonast package is tested using several approaches:

* Gomega is used as the primary assertion library for unit tests
* Schema abstraction tests verify that different schema formats are correctly processed
* Type extraction tests ensure proper mapping from JSON types to Go types
* OpenAPI file loading tests verify correct parsing of external schema references
* Golden file tests compare generated code against expected outputs

## Related packages

* **astmodel** - Provides the abstract syntax tree model used to represent Go code. The jsonast package maps JSON schemas to these AST models.
* **astbuilder** - Helps with constructing detailed AST structures. The jsonast package uses this when creating complex type definitions.
* **codegen** - Orchestrates the overall code generation process, with jsonast handling the schema parsing and initial type creation.
* **config** - Provides configuration for controlling type generation, including type filters that jsonast applies during schema processing.
* **testcases** - Consumes the types generated by jsonast to create test cases for validating the generated code.
