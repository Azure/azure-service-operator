<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Azure Service Operator â€“ Authentication in Azure Service Operator</title>
    <link>https://azure.github.io/azure-service-operator/guide/authentication/</link>
    <description>Recent content in Authentication in Azure Service Operator on Azure Service Operator</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-us</language>
    
	  <atom:link href="https://azure.github.io/azure-service-operator/guide/authentication/index.xml" rel="self" type="application/rss+xml" />
    
    
      
        
      
    
    
    <item>
      <title>Guide: Credential Format</title>
      <link>https://azure.github.io/azure-service-operator/guide/authentication/credential-format/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://azure.github.io/azure-service-operator/guide/authentication/credential-format/</guid>
      <description>
        
        
        &lt;p&gt;Azure Service Operator supports four different styles of authentication today.&lt;/p&gt;
&lt;p&gt;Each section below dives into one of these authentication options, including examples for how to set it up and
use it at the different &lt;a href=&#34;https://azure.github.io/azure-service-operator/azure-service-operator/guide/authentication/credential-scope/&#34;&gt;credential scopes&lt;/a&gt;.&lt;/p&gt;
&lt;h2 id=&#34;managed-identity-via-workload-identity&#34;&gt;Managed Identity (via workload identity)&lt;/h2&gt;
&lt;p&gt;See &lt;a href=&#34;https://github.com/Azure/azure-workload-identity&#34;&gt;Azure Workload Identity&lt;/a&gt; for details about the workload identity project.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Managed Identity (via workload identity) is the recommended authentication mode for production use-cases&lt;/strong&gt;.&lt;/p&gt;
&lt;h3 id=&#34;prerequisites&#34;&gt;Prerequisites&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;An existing Azure Service Principal or Managed Identity. The setup is the same regardless of which you choose.&lt;/li&gt;
&lt;li&gt;The &lt;a href=&#34;https://docs.microsoft.com/cli/azure/install-azure-cli&#34;&gt;Azure CLI&lt;/a&gt;.&lt;/li&gt;
&lt;li&gt;An OIDC endpoint associated with your cluster. See &lt;a href=&#34;https://learn.microsoft.com/en-us/azure/aks/use-oidc-issuer&#34;&gt;how to enable OIDC on AKS&lt;/a&gt;.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Use the following Bash commands to set the environment variables containing the workload identity secret (customize with your values):&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;export AZURE_CLIENT_ID&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;00000000-0000-0000-0000-00000000000&amp;#34;&lt;/span&gt;       &lt;span style=&#34;color:#75715e&#34;&gt;# The client ID (sometimes called App Id) of the Service Principal, or the Client ID of the Managed Identity with which you are using Workload Identity.&lt;/span&gt;
export AZURE_SUBSCRIPTION_ID&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;00000000-0000-0000-0000-00000000000&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#75715e&#34;&gt;# The Azure Subscription ID the identity is in.&lt;/span&gt;
export AZURE_TENANT_ID&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;00000000-0000-0000-0000-00000000000&amp;#34;&lt;/span&gt;       &lt;span style=&#34;color:#75715e&#34;&gt;# The Azure AAD Tenant the identity/subscription is associated with.&lt;/span&gt;
export SERVICE_ACCOUNT_ISSUER&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;https://oidc.prod-aks.azure.com/00000000-0000-0000-0000-00000000000/&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#75715e&#34;&gt;# The OIDC endpoint for your cluster in this example AKS&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;configure-trust&#34;&gt;Configure trust&lt;/h3&gt;
&lt;p&gt;Establish trust between your OIDC issuer URL and the backing Service Principal or Managed Identity. See &lt;a href=&#34;https://docs.microsoft.com/en-us/azure/active-directory/develop/workload-identity-federation#how-it-works&#34;&gt;how it works&lt;/a&gt; for details.&lt;/p&gt;




&lt;ul class=&#34;nav nav-tabs&#34; id=&#34;tabs-1&#34; role=&#34;tablist&#34;&gt;
  &lt;li class=&#34;nav-item&#34;&gt;
      &lt;a class=&#34;nav-link disabled&#34;
          id=&#34;tabs-01-00-tab&#34; data-toggle=&#34;tab&#34; href=&#34;#tabs-01-00&#34; role=&#34;tab&#34;
          aria-controls=&#34;tabs-01-00&#34; aria-selected=&#34;false&#34;&gt;
        &lt;strong&gt;Kind&lt;/strong&gt;:
      &lt;/a&gt;
    &lt;/li&gt;&lt;li class=&#34;nav-item&#34;&gt;
      &lt;a class=&#34;nav-link active&#34;
          id=&#34;tabs-01-01-tab&#34; data-toggle=&#34;tab&#34; href=&#34;#tabs-01-01&#34; role=&#34;tab&#34;
          aria-controls=&#34;tabs-01-01&#34; aria-selected=&#34;false&#34;&gt;
        Managed Identity
      &lt;/a&gt;
    &lt;/li&gt;&lt;li class=&#34;nav-item&#34;&gt;
      &lt;a class=&#34;nav-link&#34;
          id=&#34;tabs-01-02-tab&#34; data-toggle=&#34;tab&#34; href=&#34;#tabs-01-02&#34; role=&#34;tab&#34;
          aria-controls=&#34;tabs-01-02&#34; aria-selected=&#34;false&#34;&gt;
        Service Principal
      &lt;/a&gt;
    &lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&#34;tab-content&#34; id=&#34;tabs-1-content&#34;&gt;
    &lt;div class=&#34;tab-body tab-pane fade&#34;
        id=&#34;tabs-01-00&#34; role=&#34;tabpanel&#34; aria-labelled-by=&#34;tabs-01-00-tab&#34;&gt;
        
    &lt;/div&gt;
    &lt;div class=&#34;tab-body tab-pane fade show active&#34;
        id=&#34;tabs-01-01&#34; role=&#34;tabpanel&#34; aria-labelled-by=&#34;tabs-01-01-tab&#34;&gt;
        &lt;p&gt;Set the following additional environment variables:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;export MI_RESOURCE_GROUP&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;my-rg&amp;#34;&lt;/span&gt;  &lt;span style=&#34;color:#75715e&#34;&gt;# The resource group containing the managed identity that will be used by ASO&lt;/span&gt;
export MI_NAME&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;my-mi&amp;#34;&lt;/span&gt;            &lt;span style=&#34;color:#75715e&#34;&gt;# The name of the managed identity that will be used by ASO&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Create the Federated Identity Credential registering your service account with AAD:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;az identity federated-credential create --name aso-federated-credential --identity-name &lt;span style=&#34;color:#e6db74&#34;&gt;${&lt;/span&gt;MI_NAME&lt;span style=&#34;color:#e6db74&#34;&gt;}&lt;/span&gt; --resource-group &lt;span style=&#34;color:#e6db74&#34;&gt;${&lt;/span&gt;MI_RESOURCE_GROUP&lt;span style=&#34;color:#e6db74&#34;&gt;}&lt;/span&gt; --issuer &lt;span style=&#34;color:#e6db74&#34;&gt;${&lt;/span&gt;SERVICE_ACCOUNT_ISSUER&lt;span style=&#34;color:#e6db74&#34;&gt;}&lt;/span&gt; --subject &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;system:serviceaccount:azureserviceoperator-system:azureserviceoperator-default&amp;#34;&lt;/span&gt; --audiences &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;api://AzureADTokenExchange&amp;#34;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
    &lt;/div&gt;
    &lt;div class=&#34;tab-body tab-pane fade&#34;
        id=&#34;tabs-01-02&#34; role=&#34;tabpanel&#34; aria-labelled-by=&#34;tabs-01-02-tab&#34;&gt;
        &lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;export APPLICATION_OBJECT_ID&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;$(&lt;/span&gt;az ad app show --id &lt;span style=&#34;color:#e6db74&#34;&gt;${&lt;/span&gt;AZURE_CLIENT_ID&lt;span style=&#34;color:#e6db74&#34;&gt;}&lt;/span&gt; --query id -otsv&lt;span style=&#34;color:#66d9ef&#34;&gt;)&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt;

cat &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;lt;&amp;lt;EOF &amp;gt; params.json
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;{
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;  &amp;#34;name&amp;#34;: &amp;#34;aso-federated-credential&amp;#34;,
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;  &amp;#34;issuer&amp;#34;: &amp;#34;${SERVICE_ACCOUNT_ISSUER}&amp;#34;,
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;  &amp;#34;subject&amp;#34;: &amp;#34;system:serviceaccount:azureserviceoperator-system:azureserviceoperator-default&amp;#34;,
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;  &amp;#34;description&amp;#34;: &amp;#34;Kubernetes service account federated credential&amp;#34;,
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;  &amp;#34;audiences&amp;#34;: [
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;    &amp;#34;api://AzureADTokenExchange&amp;#34;
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;  ]
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;}
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;EOF&lt;/span&gt;

az ad app federated-credential create --id &lt;span style=&#34;color:#e6db74&#34;&gt;${&lt;/span&gt;APPLICATION_OBJECT_ID&lt;span style=&#34;color:#e6db74&#34;&gt;}&lt;/span&gt; --parameters @params.json
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
    &lt;/div&gt;
&lt;/div&gt;

&lt;h3 id=&#34;create-the-secret&#34;&gt;Create the secret&lt;/h3&gt;





&lt;ul class=&#34;nav nav-tabs&#34; id=&#34;tabs-2&#34; role=&#34;tablist&#34;&gt;
  &lt;li class=&#34;nav-item&#34;&gt;
      &lt;a class=&#34;nav-link disabled&#34;
          id=&#34;tabs-02-00-tab&#34; data-toggle=&#34;tab&#34; href=&#34;#tabs-02-00&#34; role=&#34;tab&#34;
          aria-controls=&#34;tabs-02-00&#34; aria-selected=&#34;false&#34;&gt;
        &lt;strong&gt;Scope&lt;/strong&gt;:
      &lt;/a&gt;
    &lt;/li&gt;&lt;li class=&#34;nav-item&#34;&gt;
      &lt;a class=&#34;nav-link active&#34;
          id=&#34;tabs-02-01-tab&#34; data-toggle=&#34;tab&#34; href=&#34;#tabs-02-01&#34; role=&#34;tab&#34;
          aria-controls=&#34;tabs-02-01&#34; aria-selected=&#34;false&#34;&gt;
        Global
      &lt;/a&gt;
    &lt;/li&gt;&lt;li class=&#34;nav-item&#34;&gt;
      &lt;a class=&#34;nav-link&#34;
          id=&#34;tabs-02-02-tab&#34; data-toggle=&#34;tab&#34; href=&#34;#tabs-02-02&#34; role=&#34;tab&#34;
          aria-controls=&#34;tabs-02-02&#34; aria-selected=&#34;false&#34;&gt;
        Namespace
      &lt;/a&gt;
    &lt;/li&gt;&lt;li class=&#34;nav-item&#34;&gt;
      &lt;a class=&#34;nav-link&#34;
          id=&#34;tabs-02-03-tab&#34; data-toggle=&#34;tab&#34; href=&#34;#tabs-02-03&#34; role=&#34;tab&#34;
          aria-controls=&#34;tabs-02-03&#34; aria-selected=&#34;false&#34;&gt;
        Resource
      &lt;/a&gt;
    &lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&#34;tab-content&#34; id=&#34;tabs-2-content&#34;&gt;
    &lt;div class=&#34;tab-body tab-pane fade&#34;
        id=&#34;tabs-02-00&#34; role=&#34;tabpanel&#34; aria-labelled-by=&#34;tabs-02-00-tab&#34;&gt;
        
    &lt;/div&gt;
    &lt;div class=&#34;tab-body tab-pane fade show active&#34;
        id=&#34;tabs-02-01&#34; role=&#34;tabpanel&#34; aria-labelled-by=&#34;tabs-02-01-tab&#34;&gt;
        &lt;p&gt;If installing ASO for the first time, you can pass these values via Helm arguments:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;helm upgrade --install --devel aso2 aso2/azure-service-operator &lt;span style=&#34;color:#ae81ff&#34;&gt;\
&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;&lt;/span&gt;        --create-namespace &lt;span style=&#34;color:#ae81ff&#34;&gt;\
&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;&lt;/span&gt;        --namespace&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;azureserviceoperator-system &lt;span style=&#34;color:#ae81ff&#34;&gt;\
&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;&lt;/span&gt;        --set azureSubscriptionID&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;$AZURE_SUBSCRIPTION_ID &lt;span style=&#34;color:#ae81ff&#34;&gt;\
&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;&lt;/span&gt;        --set azureTenantID&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;$AZURE_TENANT_ID &lt;span style=&#34;color:#ae81ff&#34;&gt;\
&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;&lt;/span&gt;        --set azureClientID&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;$AZURE_CLIENT_ID &lt;span style=&#34;color:#ae81ff&#34;&gt;\
&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;&lt;/span&gt;        --set useWorkloadIdentityAuth&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;true &lt;span style=&#34;color:#ae81ff&#34;&gt;\
&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;&lt;/span&gt;        --set crdPattern&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;resources.azure.com/*;containerservice.azure.com/*;keyvault.azure.com/*;managedidentity.azure.com/*;eventhub.azure.com/*&amp;#39;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;See &lt;a href=&#34;https://azure.github.io/azure-service-operator/azure-service-operator/guide/crd-management/&#34;&gt;CRD management&lt;/a&gt; for more details about &lt;code&gt;crdPattern&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Otherwise, create or update the &lt;code&gt;aso-controller-settings&lt;/code&gt; secret:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;cat &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;lt;&amp;lt;EOF | kubectl apply -f -
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;apiVersion: v1
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;kind: Secret
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;metadata:
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt; name: aso-controller-settings
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt; namespace: azureserviceoperator-system
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;stringData:
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt; AZURE_SUBSCRIPTION_ID: &amp;#34;$AZURE_SUBSCRIPTION_ID&amp;#34;
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt; AZURE_TENANT_ID: &amp;#34;$AZURE_TENANT_ID&amp;#34;
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt; AZURE_CLIENT_ID: &amp;#34;$AZURE_CLIENT_ID&amp;#34;
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt; USE_WORKLOAD_IDENTITY_AUTH: &amp;#34;true&amp;#34;
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;EOF&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;Note:&lt;/strong&gt; The &lt;code&gt;aso-controller-settings&lt;/code&gt; secret contains more configuration than just the global credential.
If ASO was already installed on your cluster and you are updating the &lt;code&gt;aso-controller-settings&lt;/code&gt; secret, ensure that
&lt;a href=&#34;https://azure.github.io/azure-service-operator/azure-service-operator/guide/aso-controller-settings-options/&#34;&gt;other values&lt;/a&gt; in that secret are not being overwritten.&lt;/p&gt;

    &lt;/div&gt;
    &lt;div class=&#34;tab-body tab-pane fade&#34;
        id=&#34;tabs-02-02&#34; role=&#34;tabpanel&#34; aria-labelled-by=&#34;tabs-02-02-tab&#34;&gt;
        &lt;p&gt;Create the &lt;code&gt;aso-credential&lt;/code&gt; secret in your namespace:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;cat &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;lt;&amp;lt;EOF | kubectl apply -f -
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;apiVersion: v1
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;kind: Secret
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;metadata:
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt; name: aso-credential
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt; namespace: my-namespace
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;stringData:
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt; AZURE_SUBSCRIPTION_ID: &amp;#34;$AZURE_SUBSCRIPTION_ID&amp;#34;
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt; AZURE_TENANT_ID:    &amp;#34;$AZURE_TENANT_ID&amp;#34;
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt; AZURE_CLIENT_ID:    &amp;#34;$AZURE_CLIENT_ID&amp;#34;
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;EOF&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;Note:&lt;/strong&gt; Each credential (both namespaced and per-resource) you create must have a trust relationship between your OIDC
issuer URL and the backing Service Principal or Managed Identity. See &lt;a href=&#34;#configure-trust&#34;&gt;how to configure trust&lt;/a&gt; for more details.&lt;/p&gt;

    &lt;/div&gt;
    &lt;div class=&#34;tab-body tab-pane fade&#34;
        id=&#34;tabs-02-03&#34; role=&#34;tabpanel&#34; aria-labelled-by=&#34;tabs-02-03-tab&#34;&gt;
        &lt;p&gt;Create a per-resource secret. We&amp;rsquo;ll use &lt;code&gt;my-resource-secret&lt;/code&gt;:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;cat &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;lt;&amp;lt;EOF | kubectl apply -f -
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;apiVersion: v1
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;kind: Secret
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;metadata:
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt; name: my-resource-secret
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt; namespace: my-namespace
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;stringData:
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt; AZURE_SUBSCRIPTION_ID: &amp;#34;$AZURE_SUBSCRIPTION_ID&amp;#34;
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt; AZURE_TENANT_ID:    &amp;#34;$AZURE_TENANT_ID&amp;#34;
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt; AZURE_CLIENT_ID:    &amp;#34;$AZURE_CLIENT_ID&amp;#34;
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;EOF&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Create the ASO resource referring to &lt;code&gt;my-resource-secret&lt;/code&gt;. We show a &lt;code&gt;ResourceGroup&lt;/code&gt; here, but any ASO resource will work.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;cat &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;lt;&amp;lt;EOF | kubectl apply -f -
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;apiVersion: resources.azure.com/v1api20200601
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;kind: ResourceGroup
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;metadata:
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;  name: aso-sample-rg
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;  namespace: default
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;  annotations:
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;    serviceoperator.azure.com/credential-from: my-resource-secret
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;spec:
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;  location: westcentralus
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;EOF&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;Note:&lt;/strong&gt; Each credential (both namespaced and per-resource) you create must have a trust relationship between your OIDC
issuer URL and the backing Service Principal or Managed Identity. See &lt;a href=&#34;#configure-trust&#34;&gt;how to configure trust&lt;/a&gt; for more details.&lt;/p&gt;

    &lt;/div&gt;
&lt;/div&gt;

&lt;h2 id=&#34;service-principal-using-a-client-secret&#34;&gt;Service Principal using a Client Secret&lt;/h2&gt;
&lt;h3 id=&#34;prerequisites-1&#34;&gt;Prerequisites&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;An existing Azure Service Principal.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;To use Service Principal authentication with &lt;strong&gt;client secret&lt;/strong&gt;, create a secret with the &lt;code&gt;AZURE_CLIENT_ID&lt;/code&gt; and &lt;code&gt;AZURE_CLIENT_SECRET&lt;/code&gt; keys set.&lt;/p&gt;
&lt;p&gt;For more information about Service Principals, see &lt;a href=&#34;https://learn.microsoft.com/en-us/cli/azure/azure-cli-sp-tutorial-1&#34;&gt;Work with Azure service principal using the Azure CLI&lt;/a&gt;.
The &lt;code&gt;AZURE_CLIENT_ID&lt;/code&gt; is sometimes also called the App ID. The &lt;code&gt;AZURE_CLIENT_SECRET&lt;/code&gt; is the &amp;ldquo;password&amp;rdquo; returned by the command in the previously linked documentation.&lt;/p&gt;
&lt;p&gt;Use the following Bash commands to set the environment variables containing the service principal secret (customize with your values):&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;export AZURE_CLIENT_ID&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;00000000-0000-0000-0000-00000000000&amp;#34;&lt;/span&gt;       &lt;span style=&#34;color:#75715e&#34;&gt;# The client ID (sometimes called App Id) of the Service Principal.&lt;/span&gt;
export AZURE_CLIENT_SECRET&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;00000000-0000-0000-0000-00000000000&amp;#34;&lt;/span&gt;   &lt;span style=&#34;color:#75715e&#34;&gt;# The client secret of the Service Principal.&lt;/span&gt;
export AZURE_SUBSCRIPTION_ID&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;00000000-0000-0000-0000-00000000000&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#75715e&#34;&gt;# The Azure Subscription ID the identity is in.&lt;/span&gt;
export AZURE_TENANT_ID&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;00000000-0000-0000-0000-00000000000&amp;#34;&lt;/span&gt;       &lt;span style=&#34;color:#75715e&#34;&gt;# The Azure AAD Tenant the identity/subscription is associated with.&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;create-the-secret-1&#34;&gt;Create the secret&lt;/h3&gt;





&lt;ul class=&#34;nav nav-tabs&#34; id=&#34;tabs-3&#34; role=&#34;tablist&#34;&gt;
  &lt;li class=&#34;nav-item&#34;&gt;
      &lt;a class=&#34;nav-link disabled&#34;
          id=&#34;tabs-03-00-tab&#34; data-toggle=&#34;tab&#34; href=&#34;#tabs-03-00&#34; role=&#34;tab&#34;
          aria-controls=&#34;tabs-03-00&#34; aria-selected=&#34;false&#34;&gt;
        &lt;strong&gt;Scope&lt;/strong&gt;:
      &lt;/a&gt;
    &lt;/li&gt;&lt;li class=&#34;nav-item&#34;&gt;
      &lt;a class=&#34;nav-link active&#34;
          id=&#34;tabs-03-01-tab&#34; data-toggle=&#34;tab&#34; href=&#34;#tabs-03-01&#34; role=&#34;tab&#34;
          aria-controls=&#34;tabs-03-01&#34; aria-selected=&#34;false&#34;&gt;
        Global
      &lt;/a&gt;
    &lt;/li&gt;&lt;li class=&#34;nav-item&#34;&gt;
      &lt;a class=&#34;nav-link&#34;
          id=&#34;tabs-03-02-tab&#34; data-toggle=&#34;tab&#34; href=&#34;#tabs-03-02&#34; role=&#34;tab&#34;
          aria-controls=&#34;tabs-03-02&#34; aria-selected=&#34;false&#34;&gt;
        Namespace
      &lt;/a&gt;
    &lt;/li&gt;&lt;li class=&#34;nav-item&#34;&gt;
      &lt;a class=&#34;nav-link&#34;
          id=&#34;tabs-03-03-tab&#34; data-toggle=&#34;tab&#34; href=&#34;#tabs-03-03&#34; role=&#34;tab&#34;
          aria-controls=&#34;tabs-03-03&#34; aria-selected=&#34;false&#34;&gt;
        Resource
      &lt;/a&gt;
    &lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&#34;tab-content&#34; id=&#34;tabs-3-content&#34;&gt;
    &lt;div class=&#34;tab-body tab-pane fade&#34;
        id=&#34;tabs-03-00&#34; role=&#34;tabpanel&#34; aria-labelled-by=&#34;tabs-03-00-tab&#34;&gt;
        
    &lt;/div&gt;
    &lt;div class=&#34;tab-body tab-pane fade show active&#34;
        id=&#34;tabs-03-01&#34; role=&#34;tabpanel&#34; aria-labelled-by=&#34;tabs-03-01-tab&#34;&gt;
        &lt;p&gt;If installing ASO for the first time, you can pass these values via Helm arguments:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;helm upgrade --install --devel aso2 aso2/azure-service-operator &lt;span style=&#34;color:#ae81ff&#34;&gt;\
&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;&lt;/span&gt;        --create-namespace &lt;span style=&#34;color:#ae81ff&#34;&gt;\
&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;&lt;/span&gt;        --namespace&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;azureserviceoperator-system &lt;span style=&#34;color:#ae81ff&#34;&gt;\
&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;&lt;/span&gt;        --set azureSubscriptionID&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;$AZURE_SUBSCRIPTION_ID &lt;span style=&#34;color:#ae81ff&#34;&gt;\
&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;&lt;/span&gt;        --set azureTenantID&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;$AZURE_TENANT_ID &lt;span style=&#34;color:#ae81ff&#34;&gt;\
&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;&lt;/span&gt;        --set azureClientID&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;$AZURE_CLIENT_ID &lt;span style=&#34;color:#ae81ff&#34;&gt;\
&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;&lt;/span&gt;        --set azureClientSecret&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;$AZURE_CLIENT_SECRET &lt;span style=&#34;color:#ae81ff&#34;&gt;\
&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;&lt;/span&gt;        --set crdPattern&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;resources.azure.com/*;containerservice.azure.com/*;keyvault.azure.com/*;managedidentity.azure.com/*;eventhub.azure.com/*&amp;#39;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;See &lt;a href=&#34;https://azure.github.io/azure-service-operator/azure-service-operator/guide/crd-management/&#34;&gt;CRD management&lt;/a&gt; for more details about &lt;code&gt;crdPattern&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Otherwise, create or update the &lt;code&gt;aso-controller-settings&lt;/code&gt; secret:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;cat &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;lt;&amp;lt;EOF | kubectl apply -f -
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;apiVersion: v1
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;kind: Secret
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;metadata:
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt; name: aso-controller-settings
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt; namespace: azureserviceoperator-system
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;stringData:
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt; AZURE_SUBSCRIPTION_ID: &amp;#34;$AZURE_SUBSCRIPTION_ID&amp;#34;
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt; AZURE_TENANT_ID: &amp;#34;$AZURE_TENANT_ID&amp;#34;
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt; AZURE_CLIENT_ID: &amp;#34;$AZURE_CLIENT_ID&amp;#34;
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt; AZURE_CLIENT_SECRET: &amp;#34;$AZURE_CLIENT_SECRET&amp;#34;
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;EOF&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;Note:&lt;/strong&gt; The &lt;code&gt;aso-controller-settings&lt;/code&gt; secret contains more configuration than just the global credential.
If ASO was already installed on your cluster and you are updating the &lt;code&gt;aso-controller-settings&lt;/code&gt; secret, ensure that
&lt;a href=&#34;https://azure.github.io/azure-service-operator/azure-service-operator/guide/aso-controller-settings-options/&#34;&gt;other values&lt;/a&gt; in that secret are not being overwritten.&lt;/p&gt;

    &lt;/div&gt;
    &lt;div class=&#34;tab-body tab-pane fade&#34;
        id=&#34;tabs-03-02&#34; role=&#34;tabpanel&#34; aria-labelled-by=&#34;tabs-03-02-tab&#34;&gt;
        &lt;p&gt;Create the &lt;code&gt;aso-credential&lt;/code&gt; secret in your namespace:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;cat &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;lt;&amp;lt;EOF | kubectl apply -f -
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;apiVersion: v1
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;kind: Secret
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;metadata:
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt; name: aso-credential
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt; namespace: my-namespace
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;stringData:
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt; AZURE_SUBSCRIPTION_ID: &amp;#34;$AZURE_SUBSCRIPTION_ID&amp;#34;
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt; AZURE_TENANT_ID: &amp;#34;$AZURE_TENANT_ID&amp;#34;
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt; AZURE_CLIENT_ID: &amp;#34;$AZURE_CLIENT_ID&amp;#34;
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt; AZURE_CLIENT_SECRET: &amp;#34;$AZURE_CLIENT_SECRET&amp;#34;
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;EOF&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
    &lt;/div&gt;
    &lt;div class=&#34;tab-body tab-pane fade&#34;
        id=&#34;tabs-03-03&#34; role=&#34;tabpanel&#34; aria-labelled-by=&#34;tabs-03-03-tab&#34;&gt;
        &lt;p&gt;Create a per-resource secret. We&amp;rsquo;ll use &lt;code&gt;my-resource-secret&lt;/code&gt;:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;cat &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;lt;&amp;lt;EOF | kubectl apply -f -
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;apiVersion: v1
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;kind: Secret
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;metadata:
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt; name: my-resource-secret
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt; namespace: my-namespace
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;stringData:
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt; AZURE_SUBSCRIPTION_ID: &amp;#34;$AZURE_SUBSCRIPTION_ID&amp;#34;
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt; AZURE_TENANT_ID: &amp;#34;$AZURE_TENANT_ID&amp;#34;
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt; AZURE_CLIENT_ID: &amp;#34;$AZURE_CLIENT_ID&amp;#34;
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt; AZURE_CLIENT_SECRET: &amp;#34;$AZURE_CLIENT_SECRET&amp;#34;
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;EOF&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Create the ASO resource referring to &lt;code&gt;my-resource-secret&lt;/code&gt;. We show a &lt;code&gt;ResourceGroup&lt;/code&gt; here, but any ASO resource will work.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;cat &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;lt;&amp;lt;EOF | kubectl apply -f -
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;apiVersion: resources.azure.com/v1api20200601
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;kind: ResourceGroup
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;metadata:
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;  name: aso-sample-rg
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;  namespace: default
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;  annotation:
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;    serviceoperator.azure.com/credential-from: my-resource-secret
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;spec:
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;  location: westcentralus
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;EOF&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
    &lt;/div&gt;
&lt;/div&gt;

&lt;h2 id=&#34;service-principal-using-a-client-certificate&#34;&gt;Service Principal using a Client Certificate&lt;/h2&gt;
&lt;h3 id=&#34;prerequisites-2&#34;&gt;Prerequisites&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;An existing Azure Service Principal.&lt;/li&gt;
&lt;li&gt;X.509 certificate in ASCII format such as PEM, CER, or DER.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;To use Service Principal authentication via client certificate, create a secret with the &lt;code&gt;AZURE_CLIENT_ID&lt;/code&gt;, &lt;code&gt;AZURE_CLIENT_CERTIFICATE&lt;/code&gt; and &lt;code&gt;AZURE_CLIENT_CERTIFICATE_PASSWORD&lt;/code&gt;(optional) keys set.&lt;/p&gt;
&lt;p&gt;For more information about creating Service Principals with certificate, see &lt;a href=&#34;https://learn.microsoft.com/en-us/cli/azure/azure-cli-sp-tutorial-3?tabs=concepts&#34;&gt;creating an Azure Service Principal using certificate based authentication&lt;/a&gt;.
The &lt;code&gt;AZURE_CLIENT_ID&lt;/code&gt; is sometimes also called the App ID. The &lt;code&gt;AZURE_CLIENT_CERTIFICATE&lt;/code&gt; is the &lt;em&gt;certificate&lt;/em&gt; returned by the command in the previously linked documentation.&lt;/p&gt;
&lt;p&gt;Use the following Bash commands to set the environment variables containing the service principal certificate secret (customize with your values):&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;export AZURE_CLIENT_ID&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;00000000-0000-0000-0000-00000000000&amp;#34;&lt;/span&gt;          &lt;span style=&#34;color:#75715e&#34;&gt;# The client ID (sometimes called App Id) of the Service Principal.&lt;/span&gt;
export AZURE_SUBSCRIPTION_ID&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;00000000-0000-0000-0000-00000000000&amp;#34;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;# The Azure Subscription ID the identity is in.&lt;/span&gt;
export AZURE_TENANT_ID&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;00000000-0000-0000-0000-00000000000&amp;#34;&lt;/span&gt;          &lt;span style=&#34;color:#75715e&#34;&gt;# The Azure AAD Tenant the identity/subscription is associated with.&lt;/span&gt;
export AZURE_CLIENT_CERTIFICATE&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;`&lt;/span&gt;cat path/to/certFile.pem&lt;span style=&#34;color:#e6db74&#34;&gt;`&lt;/span&gt;                    &lt;span style=&#34;color:#75715e&#34;&gt;# The client certificate of the Service Principal.&lt;/span&gt;
export AZURE_CLIENT_CERTIFICATE_PASSWORD&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;myPrivateKeyValue&amp;#34;&lt;/span&gt;          &lt;span style=&#34;color:#75715e&#34;&gt;# The private key for the above certificate (optional)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;create-the-secret-2&#34;&gt;Create the secret&lt;/h3&gt;





&lt;ul class=&#34;nav nav-tabs&#34; id=&#34;tabs-4&#34; role=&#34;tablist&#34;&gt;
  &lt;li class=&#34;nav-item&#34;&gt;
      &lt;a class=&#34;nav-link disabled&#34;
          id=&#34;tabs-04-00-tab&#34; data-toggle=&#34;tab&#34; href=&#34;#tabs-04-00&#34; role=&#34;tab&#34;
          aria-controls=&#34;tabs-04-00&#34; aria-selected=&#34;false&#34;&gt;
        &lt;strong&gt;Scope&lt;/strong&gt;:
      &lt;/a&gt;
    &lt;/li&gt;&lt;li class=&#34;nav-item&#34;&gt;
      &lt;a class=&#34;nav-link active&#34;
          id=&#34;tabs-04-01-tab&#34; data-toggle=&#34;tab&#34; href=&#34;#tabs-04-01&#34; role=&#34;tab&#34;
          aria-controls=&#34;tabs-04-01&#34; aria-selected=&#34;false&#34;&gt;
        Global
      &lt;/a&gt;
    &lt;/li&gt;&lt;li class=&#34;nav-item&#34;&gt;
      &lt;a class=&#34;nav-link&#34;
          id=&#34;tabs-04-02-tab&#34; data-toggle=&#34;tab&#34; href=&#34;#tabs-04-02&#34; role=&#34;tab&#34;
          aria-controls=&#34;tabs-04-02&#34; aria-selected=&#34;false&#34;&gt;
        Namespace
      &lt;/a&gt;
    &lt;/li&gt;&lt;li class=&#34;nav-item&#34;&gt;
      &lt;a class=&#34;nav-link&#34;
          id=&#34;tabs-04-03-tab&#34; data-toggle=&#34;tab&#34; href=&#34;#tabs-04-03&#34; role=&#34;tab&#34;
          aria-controls=&#34;tabs-04-03&#34; aria-selected=&#34;false&#34;&gt;
        Resource
      &lt;/a&gt;
    &lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&#34;tab-content&#34; id=&#34;tabs-4-content&#34;&gt;
    &lt;div class=&#34;tab-body tab-pane fade&#34;
        id=&#34;tabs-04-00&#34; role=&#34;tabpanel&#34; aria-labelled-by=&#34;tabs-04-00-tab&#34;&gt;
        
    &lt;/div&gt;
    &lt;div class=&#34;tab-body tab-pane fade show active&#34;
        id=&#34;tabs-04-01&#34; role=&#34;tabpanel&#34; aria-labelled-by=&#34;tabs-04-01-tab&#34;&gt;
        &lt;p&gt;If installing ASO for the first time, you can pass these values via Helm arguments:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;helm upgrade --install --devel aso2 aso2/azure-service-operator &lt;span style=&#34;color:#ae81ff&#34;&gt;\
&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;&lt;/span&gt;        --create-namespace &lt;span style=&#34;color:#ae81ff&#34;&gt;\
&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;&lt;/span&gt;        --namespace&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;azureserviceoperator-system &lt;span style=&#34;color:#ae81ff&#34;&gt;\
&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;&lt;/span&gt;        --set azureSubscriptionID&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;$AZURE_SUBSCRIPTION_ID &lt;span style=&#34;color:#ae81ff&#34;&gt;\
&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;&lt;/span&gt;        --set azureTenantID&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;$AZURE_TENANT_ID &lt;span style=&#34;color:#ae81ff&#34;&gt;\
&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;&lt;/span&gt;        --set azureClientID&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;$AZURE_CLIENT_ID &lt;span style=&#34;color:#ae81ff&#34;&gt;\
&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;&lt;/span&gt;        --set azureClientCertificatePassword&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;$AZURE_CLIENT_CERTIFICATE_PASSWORD &lt;span style=&#34;color:#ae81ff&#34;&gt;\
&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;&lt;/span&gt;        --set crdPattern&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;resources.azure.com/*;containerservice.azure.com/*;keyvault.azure.com/*;managedidentity.azure.com/*;eventhub.azure.com/*&amp;#39;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;See &lt;a href=&#34;https://azure.github.io/azure-service-operator/azure-service-operator/guide/crd-management/&#34;&gt;CRD management&lt;/a&gt; for more details about &lt;code&gt;crdPattern&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Otherwise, create or update the &lt;code&gt;aso-controller-settings&lt;/code&gt; secret:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;cat &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;lt;&amp;lt;EOF | kubectl apply -f -
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;apiVersion: v1
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;kind: Secret
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;metadata:
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt; name: aso-controller-settings
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt; namespace: azureserviceoperator-system
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;stringData:
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt; AZURE_SUBSCRIPTION_ID: &amp;#34;$AZURE_SUBSCRIPTION_ID&amp;#34;
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt; AZURE_TENANT_ID: &amp;#34;$AZURE_TENANT_ID&amp;#34;
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt; AZURE_CLIENT_ID: &amp;#34;$AZURE_CLIENT_ID&amp;#34;
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt; AZURE_CLIENT_CERTIFICATE: &amp;#34;$AZURE_CLIENT_CERTIFICATE&amp;#34;
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt; AZURE_CLIENT_CERTIFICATE_PASSWORD: &amp;#34;$AZURE_CLIENT_CERTIFICATE_PASSWORD&amp;#34;
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;EOF&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;Note:&lt;/strong&gt; The &lt;code&gt;aso-controller-settings&lt;/code&gt; secret contains more configuration than just the global credential.
If ASO was already installed on your cluster and you are updating the &lt;code&gt;aso-controller-settings&lt;/code&gt; secret, ensure that
&lt;a href=&#34;https://azure.github.io/azure-service-operator/azure-service-operator/guide/aso-controller-settings-options/&#34;&gt;other values&lt;/a&gt; in that secret are not being overwritten.&lt;/p&gt;

    &lt;/div&gt;
    &lt;div class=&#34;tab-body tab-pane fade&#34;
        id=&#34;tabs-04-02&#34; role=&#34;tabpanel&#34; aria-labelled-by=&#34;tabs-04-02-tab&#34;&gt;
        &lt;p&gt;Create the &lt;code&gt;aso-credential&lt;/code&gt; secret in your namespace:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;cat &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;lt;&amp;lt;EOF | kubectl apply -f -
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;apiVersion: v1
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;kind: Secret
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;metadata:
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt; name: aso-credential
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt; namespace: my-namespace
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;stringData:
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt; AZURE_SUBSCRIPTION_ID: &amp;#34;$AZURE_SUBSCRIPTION_ID&amp;#34;
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt; AZURE_TENANT_ID: &amp;#34;$AZURE_TENANT_ID&amp;#34;
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt; AZURE_CLIENT_ID: &amp;#34;$AZURE_CLIENT_ID&amp;#34;
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt; AZURE_CLIENT_CERTIFICATE: &amp;#34;$AZURE_CLIENT_CERTIFICATE&amp;#34;
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt; AZURE_CLIENT_CERTIFICATE_PASSWORD: &amp;#34;$AZURE_CLIENT_CERTIFICATE_PASSWORD&amp;#34;
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;EOF&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
    &lt;/div&gt;
    &lt;div class=&#34;tab-body tab-pane fade&#34;
        id=&#34;tabs-04-03&#34; role=&#34;tabpanel&#34; aria-labelled-by=&#34;tabs-04-03-tab&#34;&gt;
        &lt;p&gt;Create a per-resource secret. We&amp;rsquo;ll use &lt;code&gt;my-resource-secret&lt;/code&gt;:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;cat &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;lt;&amp;lt;EOF | kubectl apply -f -
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;apiVersion: v1
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;kind: Secret
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;metadata:
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt; name: my-resource-secret
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt; namespace: my-namespace
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;stringData:
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt; AZURE_SUBSCRIPTION_ID: &amp;#34;$AZURE_SUBSCRIPTION_ID&amp;#34;
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt; AZURE_TENANT_ID: &amp;#34;$AZURE_TENANT_ID&amp;#34;
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt; AZURE_CLIENT_ID: &amp;#34;$AZURE_CLIENT_ID&amp;#34;
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt; AZURE_CLIENT_CERTIFICATE: &amp;#34;$AZURE_CLIENT_CERTIFICATE&amp;#34;
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt; AZURE_CLIENT_CERTIFICATE_PASSWORD: &amp;#34;$AZURE_CLIENT_CERTIFICATE_PASSWORD&amp;#34;
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;EOF&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Create the ASO resource referring to &lt;code&gt;my-resource-secret&lt;/code&gt;. We show a &lt;code&gt;ResourceGroup&lt;/code&gt; here, but any ASO resource will work.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;cat &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;lt;&amp;lt;EOF | kubectl apply -f -
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;apiVersion: resources.azure.com/v1api20200601
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;kind: ResourceGroup
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;metadata:
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;  name: aso-sample-rg
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;  namespace: default
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;  annotation:
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;    serviceoperator.azure.com/credential-from: my-resource-secret
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;spec:
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;  location: westcentralus
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;EOF&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
    &lt;/div&gt;
&lt;/div&gt;

&lt;h2 id=&#34;managed-identity-via-imds-on-azure-infrastructure&#34;&gt;Managed Identity (via IMDS on Azure infrastructure)&lt;/h2&gt;
&lt;h3 id=&#34;prerequisites-3&#34;&gt;Prerequisites&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;An existing Azure Managed Identity.&lt;/li&gt;
&lt;li&gt;ASO running on Azure infrastructure (such as an AKS cluster) with the Managed Identity assigned to that infrastructure.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;First, set the following environment variables:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;export IDENTITY_RESOURCE_GROUP&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;myrg&amp;#34;&lt;/span&gt;                              &lt;span style=&#34;color:#75715e&#34;&gt;# The resource group containing the managed identity.&lt;/span&gt;
export IDENTITY_NAME&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;myidentity&amp;#34;&lt;/span&gt;                                  &lt;span style=&#34;color:#75715e&#34;&gt;# The name of the identity.&lt;/span&gt;
export AZURE_SUBSCRIPTION_ID&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;00000000-0000-0000-0000-00000000000&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#75715e&#34;&gt;# The Azure Subscription ID the identity is in.&lt;/span&gt;
export AZURE_TENANT_ID&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;00000000-0000-0000-0000-00000000000&amp;#34;&lt;/span&gt;       &lt;span style=&#34;color:#75715e&#34;&gt;# The Azure AAD Tenant the identity/subscription is associated with.&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Use the &lt;code&gt;az cli&lt;/code&gt; to get some more details about the identity to use:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;export IDENTITY_CLIENT_ID&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;$(&lt;/span&gt;az identity show -g &lt;span style=&#34;color:#e6db74&#34;&gt;${&lt;/span&gt;IDENTITY_RESOURCE_GROUP&lt;span style=&#34;color:#e6db74&#34;&gt;}&lt;/span&gt; -n &lt;span style=&#34;color:#e6db74&#34;&gt;${&lt;/span&gt;IDENTITY_NAME&lt;span style=&#34;color:#e6db74&#34;&gt;}&lt;/span&gt; --query clientId -otsv&lt;span style=&#34;color:#66d9ef&#34;&gt;)&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt;
export IDENTITY_RESOURCE_ID&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;$(&lt;/span&gt;az identity show -g &lt;span style=&#34;color:#e6db74&#34;&gt;${&lt;/span&gt;IDENTITY_RESOURCE_GROUP&lt;span style=&#34;color:#e6db74&#34;&gt;}&lt;/span&gt; -n &lt;span style=&#34;color:#e6db74&#34;&gt;${&lt;/span&gt;IDENTITY_NAME&lt;span style=&#34;color:#e6db74&#34;&gt;}&lt;/span&gt; --query id -otsv&lt;span style=&#34;color:#66d9ef&#34;&gt;)&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;create-the-secret-3&#34;&gt;Create the secret&lt;/h3&gt;





&lt;ul class=&#34;nav nav-tabs&#34; id=&#34;tabs-5&#34; role=&#34;tablist&#34;&gt;
  &lt;li class=&#34;nav-item&#34;&gt;
      &lt;a class=&#34;nav-link disabled&#34;
          id=&#34;tabs-05-00-tab&#34; data-toggle=&#34;tab&#34; href=&#34;#tabs-05-00&#34; role=&#34;tab&#34;
          aria-controls=&#34;tabs-05-00&#34; aria-selected=&#34;false&#34;&gt;
        &lt;strong&gt;Scope&lt;/strong&gt;:
      &lt;/a&gt;
    &lt;/li&gt;&lt;li class=&#34;nav-item&#34;&gt;
      &lt;a class=&#34;nav-link active&#34;
          id=&#34;tabs-05-01-tab&#34; data-toggle=&#34;tab&#34; href=&#34;#tabs-05-01&#34; role=&#34;tab&#34;
          aria-controls=&#34;tabs-05-01&#34; aria-selected=&#34;false&#34;&gt;
        Global
      &lt;/a&gt;
    &lt;/li&gt;&lt;li class=&#34;nav-item&#34;&gt;
      &lt;a class=&#34;nav-link&#34;
          id=&#34;tabs-05-02-tab&#34; data-toggle=&#34;tab&#34; href=&#34;#tabs-05-02&#34; role=&#34;tab&#34;
          aria-controls=&#34;tabs-05-02&#34; aria-selected=&#34;false&#34;&gt;
        Namespace
      &lt;/a&gt;
    &lt;/li&gt;&lt;li class=&#34;nav-item&#34;&gt;
      &lt;a class=&#34;nav-link&#34;
          id=&#34;tabs-05-03-tab&#34; data-toggle=&#34;tab&#34; href=&#34;#tabs-05-03&#34; role=&#34;tab&#34;
          aria-controls=&#34;tabs-05-03&#34; aria-selected=&#34;false&#34;&gt;
        Resource
      &lt;/a&gt;
    &lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&#34;tab-content&#34; id=&#34;tabs-5-content&#34;&gt;
    &lt;div class=&#34;tab-body tab-pane fade&#34;
        id=&#34;tabs-05-00&#34; role=&#34;tabpanel&#34; aria-labelled-by=&#34;tabs-05-00-tab&#34;&gt;
        
    &lt;/div&gt;
    &lt;div class=&#34;tab-body tab-pane fade show active&#34;
        id=&#34;tabs-05-01&#34; role=&#34;tabpanel&#34; aria-labelled-by=&#34;tabs-05-01-tab&#34;&gt;
        &lt;p&gt;If installing ASO for the first time, you can pass these values via Helm arguments:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;helm upgrade --install --devel aso2 aso2/azure-service-operator &lt;span style=&#34;color:#ae81ff&#34;&gt;\
&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;&lt;/span&gt;     --create-namespace &lt;span style=&#34;color:#ae81ff&#34;&gt;\
&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;&lt;/span&gt;     --namespace&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;azureserviceoperator-system &lt;span style=&#34;color:#ae81ff&#34;&gt;\
&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;&lt;/span&gt;     --set azureSubscriptionID&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;$AZURE_SUBSCRIPTION_ID &lt;span style=&#34;color:#ae81ff&#34;&gt;\
&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;&lt;/span&gt;     --set azureClientID&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;${&lt;/span&gt;IDENTITY_CLIENT_ID&lt;span style=&#34;color:#e6db74&#34;&gt;}&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;\
&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;&lt;/span&gt;     --set crdPattern&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;resources.azure.com/*;containerservice.azure.com/*;keyvault.azure.com/*;managedidentity.azure.com/*;eventhub.azure.com/*&amp;#39;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;See &lt;a href=&#34;https://azure.github.io/azure-service-operator/azure-service-operator/guide/crd-management/&#34;&gt;CRD management&lt;/a&gt; for more details about &lt;code&gt;crdPattern&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Create or update the &lt;code&gt;aso-controller-settings&lt;/code&gt; secret:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;cat &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;lt;&amp;lt;EOF | kubectl apply -f -
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;apiVersion: v1
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;kind: Secret
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;metadata:
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt; name: aso-controller-settings
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt; namespace: azureserviceoperator-system
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;stringData:
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt; AZURE_SUBSCRIPTION_ID: &amp;#34;$AZURE_SUBSCRIPTION_ID&amp;#34;
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt; AZURE_TENANT_ID: &amp;#34;$AZURE_TENANT_ID&amp;#34;
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt; AZURE_CLIENT_ID: &amp;#34;$IDENTITY_CLIENT_ID&amp;#34;
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;EOF&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;Note:&lt;/strong&gt; The &lt;code&gt;aso-controller-settings&lt;/code&gt; secret contains more configuration than just the global credential.
If ASO was already installed on your cluster and you are updating the &lt;code&gt;aso-controller-settings&lt;/code&gt; secret, ensure that
&lt;a href=&#34;https://azure.github.io/azure-service-operator/azure-service-operator/guide/aso-controller-settings-options/&#34;&gt;other values&lt;/a&gt; in that secret are not being overwritten.&lt;/p&gt;

    &lt;/div&gt;
    &lt;div class=&#34;tab-body tab-pane fade&#34;
        id=&#34;tabs-05-02&#34; role=&#34;tabpanel&#34; aria-labelled-by=&#34;tabs-05-02-tab&#34;&gt;
        &lt;p&gt;Create the &lt;code&gt;aso-credential&lt;/code&gt; secret in your namespace:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;cat &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;lt;&amp;lt;EOF | kubectl apply -f -
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;apiVersion: v1
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;kind: Secret
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;metadata:
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt; name: aso-credential
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt; namespace: my-namespace
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;stringData:
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt; AZURE_SUBSCRIPTION_ID: &amp;#34;$AZURE_SUBSCRIPTION_ID&amp;#34;
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt; AZURE_TENANT_ID:       &amp;#34;$AZURE_TENANT_ID&amp;#34;
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt; AZURE_CLIENT_ID:       &amp;#34;$IDENTITY_CLIENT_ID&amp;#34;
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt; AUTH_MODE:             &amp;#34;podidentity&amp;#34;
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;EOF&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
    &lt;/div&gt;
    &lt;div class=&#34;tab-body tab-pane fade&#34;
        id=&#34;tabs-05-03&#34; role=&#34;tabpanel&#34; aria-labelled-by=&#34;tabs-05-03-tab&#34;&gt;
        &lt;p&gt;Create a per-resource secret. We&amp;rsquo;ll use &lt;code&gt;my-resource-secret&lt;/code&gt;:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;cat &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;lt;&amp;lt;EOF | kubectl apply -f -
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;apiVersion: v1
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;kind: Secret
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;metadata:
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt; name: my-resource-secret
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt; namespace: my-namespace
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;stringData:
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt; AZURE_SUBSCRIPTION_ID: &amp;#34;$AZURE_SUBSCRIPTION_ID&amp;#34;
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt; AZURE_TENANT_ID:       &amp;#34;$AZURE_TENANT_ID&amp;#34;
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt; AZURE_CLIENT_ID:       &amp;#34;$IDENTITY_CLIENT_ID&amp;#34;
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt; AUTH_MODE:             &amp;#34;podidentity&amp;#34;
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;EOF&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Create the ASO resource referring to &lt;code&gt;my-resource-secret&lt;/code&gt;. We show a &lt;code&gt;ResourceGroup&lt;/code&gt; here, but any ASO resource will work.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;cat &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;lt;&amp;lt;EOF | kubectl apply -f -
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;apiVersion: resources.azure.com/v1api20200601
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;kind: ResourceGroup
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;metadata:
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;  name: aso-sample-rg
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;  namespace: default
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;  annotations:
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;    serviceoperator.azure.com/credential-from: my-resource-secret
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;spec:
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;  location: westcentralus
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;EOF&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
    &lt;/div&gt;
&lt;/div&gt;

&lt;h2 id=&#34;deprecated-managed-identity-aad-pod-identity&#34;&gt;[Deprecated] Managed Identity (aad-pod-identity)&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;This authentication mechanism still works but is deprecated. See &lt;a href=&#34;#managed-identity-via-workload-identity&#34;&gt;Managed Identity (via workload identity)&lt;/a&gt; for the new way&lt;/strong&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&#34;prerequisites-4&#34;&gt;Prerequisites&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;An existing Azure Managed Identity.&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/Azure/aad-pod-identity&#34;&gt;aad-pod-identity&lt;/a&gt; installed into your cluster. If you are running ASO on an Azure Kubernetes Service (AKS) cluster, you can instead use the
&lt;a href=&#34;https://docs.microsoft.com/azure/aks/use-azure-ad-pod-identity&#34;&gt;integrated aad-pod-identity&lt;/a&gt;.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;First, set the following environment variables:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;export IDENTITY_RESOURCE_GROUP&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;myrg&amp;#34;&lt;/span&gt;                              &lt;span style=&#34;color:#75715e&#34;&gt;# The resource group containing the managed identity.&lt;/span&gt;
export IDENTITY_NAME&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;myidentity&amp;#34;&lt;/span&gt;                                  &lt;span style=&#34;color:#75715e&#34;&gt;# The name of the identity.&lt;/span&gt;
export AZURE_SUBSCRIPTION_ID&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;00000000-0000-0000-0000-00000000000&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#75715e&#34;&gt;# The Azure Subscription ID the identity is in.&lt;/span&gt;
export AZURE_TENANT_ID&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;00000000-0000-0000-0000-00000000000&amp;#34;&lt;/span&gt;       &lt;span style=&#34;color:#75715e&#34;&gt;# The Azure AAD Tenant the identity/subscription is associated with.&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Use the &lt;code&gt;az cli&lt;/code&gt; to get some more details about the identity to use:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;export IDENTITY_CLIENT_ID&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;$(&lt;/span&gt;az identity show -g &lt;span style=&#34;color:#e6db74&#34;&gt;${&lt;/span&gt;IDENTITY_RESOURCE_GROUP&lt;span style=&#34;color:#e6db74&#34;&gt;}&lt;/span&gt; -n &lt;span style=&#34;color:#e6db74&#34;&gt;${&lt;/span&gt;IDENTITY_NAME&lt;span style=&#34;color:#e6db74&#34;&gt;}&lt;/span&gt; --query clientId -otsv&lt;span style=&#34;color:#66d9ef&#34;&gt;)&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt;
export IDENTITY_RESOURCE_ID&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;$(&lt;/span&gt;az identity show -g &lt;span style=&#34;color:#e6db74&#34;&gt;${&lt;/span&gt;IDENTITY_RESOURCE_GROUP&lt;span style=&#34;color:#e6db74&#34;&gt;}&lt;/span&gt; -n &lt;span style=&#34;color:#e6db74&#34;&gt;${&lt;/span&gt;IDENTITY_NAME&lt;span style=&#34;color:#e6db74&#34;&gt;}&lt;/span&gt; --query id -otsv&lt;span style=&#34;color:#66d9ef&#34;&gt;)&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;create-the-secret-4&#34;&gt;Create the secret&lt;/h3&gt;





&lt;ul class=&#34;nav nav-tabs&#34; id=&#34;tabs-6&#34; role=&#34;tablist&#34;&gt;
  &lt;li class=&#34;nav-item&#34;&gt;
      &lt;a class=&#34;nav-link disabled&#34;
          id=&#34;tabs-06-00-tab&#34; data-toggle=&#34;tab&#34; href=&#34;#tabs-06-00&#34; role=&#34;tab&#34;
          aria-controls=&#34;tabs-06-00&#34; aria-selected=&#34;false&#34;&gt;
        &lt;strong&gt;Scope&lt;/strong&gt;:
      &lt;/a&gt;
    &lt;/li&gt;&lt;li class=&#34;nav-item&#34;&gt;
      &lt;a class=&#34;nav-link active&#34;
          id=&#34;tabs-06-01-tab&#34; data-toggle=&#34;tab&#34; href=&#34;#tabs-06-01&#34; role=&#34;tab&#34;
          aria-controls=&#34;tabs-06-01&#34; aria-selected=&#34;false&#34;&gt;
        Global
      &lt;/a&gt;
    &lt;/li&gt;&lt;li class=&#34;nav-item&#34;&gt;
      &lt;a class=&#34;nav-link&#34;
          id=&#34;tabs-06-02-tab&#34; data-toggle=&#34;tab&#34; href=&#34;#tabs-06-02&#34; role=&#34;tab&#34;
          aria-controls=&#34;tabs-06-02&#34; aria-selected=&#34;false&#34;&gt;
        Namespace
      &lt;/a&gt;
    &lt;/li&gt;&lt;li class=&#34;nav-item&#34;&gt;
      &lt;a class=&#34;nav-link&#34;
          id=&#34;tabs-06-03-tab&#34; data-toggle=&#34;tab&#34; href=&#34;#tabs-06-03&#34; role=&#34;tab&#34;
          aria-controls=&#34;tabs-06-03&#34; aria-selected=&#34;false&#34;&gt;
        Resource
      &lt;/a&gt;
    &lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&#34;tab-content&#34; id=&#34;tabs-6-content&#34;&gt;
    &lt;div class=&#34;tab-body tab-pane fade&#34;
        id=&#34;tabs-06-00&#34; role=&#34;tabpanel&#34; aria-labelled-by=&#34;tabs-06-00-tab&#34;&gt;
        
    &lt;/div&gt;
    &lt;div class=&#34;tab-body tab-pane fade show active&#34;
        id=&#34;tabs-06-01&#34; role=&#34;tabpanel&#34; aria-labelled-by=&#34;tabs-06-01-tab&#34;&gt;
        &lt;p&gt;If installing ASO for the first time, you can pass these values via Helm arguments:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;helm upgrade --install --devel aso2 aso2/azure-service-operator &lt;span style=&#34;color:#ae81ff&#34;&gt;\
&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;&lt;/span&gt;     --create-namespace &lt;span style=&#34;color:#ae81ff&#34;&gt;\
&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;&lt;/span&gt;     --namespace&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;azureserviceoperator-system &lt;span style=&#34;color:#ae81ff&#34;&gt;\
&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;&lt;/span&gt;     --set azureSubscriptionID&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;$AZURE_SUBSCRIPTION_ID &lt;span style=&#34;color:#ae81ff&#34;&gt;\
&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;&lt;/span&gt;     --set aadPodIdentity.enable&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;true &lt;span style=&#34;color:#ae81ff&#34;&gt;\
&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;&lt;/span&gt;     --set aadPodIdentity.azureManagedIdentityResourceId&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;${&lt;/span&gt;IDENTITY_RESOURCE_ID&lt;span style=&#34;color:#e6db74&#34;&gt;}&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;\
&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;&lt;/span&gt;     --set azureClientID&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;${&lt;/span&gt;IDENTITY_CLIENT_ID&lt;span style=&#34;color:#e6db74&#34;&gt;}&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;\
&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;&lt;/span&gt;     --set crdPattern&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;resources.azure.com/*;containerservice.azure.com/*;keyvault.azure.com/*;managedidentity.azure.com/*;eventhub.azure.com/*&amp;#39;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;See &lt;a href=&#34;https://azure.github.io/azure-service-operator/azure-service-operator/guide/crd-management/&#34;&gt;CRD management&lt;/a&gt; for more details about &lt;code&gt;crdPattern&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Otherwise, if deploying manually:&lt;/p&gt;
&lt;p&gt;Deploy an &lt;code&gt;AzureIdentity&lt;/code&gt;:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;cat &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;lt;&amp;lt;EOF | kubectl apply -f -
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;apiVersion: &amp;#34;aadpodidentity.k8s.io/v1&amp;#34;
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;kind: AzureIdentity
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;metadata:
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;  name: aso-identity
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;  namespace: azureserviceoperator-system
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;spec:
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;  type: 0
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;  resourceID: ${IDENTITY_RESOURCE_ID}
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;  clientID: ${IDENTITY_CLIENT_ID}
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;EOF&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Deploy an &lt;code&gt;AzureIdentityBinding&lt;/code&gt; to bind this identity to the Azure Service Operator manager pod:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;cat &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;lt;&amp;lt;EOF | kubectl apply -f -
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;apiVersion: &amp;#34;aadpodidentity.k8s.io/v1&amp;#34;
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;kind: AzureIdentityBinding
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;metadata:
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;  name: aso-identity-binding
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;  namespace: azureserviceoperator-system
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;spec:
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;  azureIdentity: aso-identity
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;  selector: aso-manager-binding
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;EOF&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Create or update the &lt;code&gt;aso-controller-settings&lt;/code&gt; secret:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;cat &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;lt;&amp;lt;EOF | kubectl apply -f -
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;apiVersion: v1
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;kind: Secret
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;metadata:
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt; name: aso-controller-settings
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt; namespace: azureserviceoperator-system
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;stringData:
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt; AZURE_SUBSCRIPTION_ID: &amp;#34;$AZURE_SUBSCRIPTION_ID&amp;#34;
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt; AZURE_TENANT_ID: &amp;#34;$AZURE_TENANT_ID&amp;#34;
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt; AZURE_CLIENT_ID: &amp;#34;$IDENTITY_CLIENT_ID&amp;#34;
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;EOF&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;Note:&lt;/strong&gt; The &lt;code&gt;aso-controller-settings&lt;/code&gt; secret contains more configuration than just the global credential.
If ASO was already installed on your cluster and you are updating the &lt;code&gt;aso-controller-settings&lt;/code&gt; secret, ensure that
&lt;a href=&#34;https://azure.github.io/azure-service-operator/azure-service-operator/guide/aso-controller-settings-options/&#34;&gt;other values&lt;/a&gt; in that secret are not being overwritten.&lt;/p&gt;

    &lt;/div&gt;
    &lt;div class=&#34;tab-body tab-pane fade&#34;
        id=&#34;tabs-06-02&#34; role=&#34;tabpanel&#34; aria-labelled-by=&#34;tabs-06-02-tab&#34;&gt;
        &lt;p&gt;Deploy an &lt;code&gt;AzureIdentity&lt;/code&gt;:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;cat &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;lt;&amp;lt;EOF | kubectl apply -f -
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;apiVersion: &amp;#34;aadpodidentity.k8s.io/v1&amp;#34;
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;kind: AzureIdentity
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;metadata:
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;  name: aso-identity
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;  namespace: azureserviceoperator-system
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;spec:
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;  type: 0
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;  resourceID: ${IDENTITY_RESOURCE_ID}
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;  clientID: ${IDENTITY_CLIENT_ID}
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;EOF&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Deploy an &lt;code&gt;AzureIdentityBinding&lt;/code&gt; to bind this identity to the Azure Service Operator manager pod:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;cat &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;lt;&amp;lt;EOF | kubectl apply -f -
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;apiVersion: &amp;#34;aadpodidentity.k8s.io/v1&amp;#34;
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;kind: AzureIdentityBinding
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;metadata:
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;  name: aso-identity-binding
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;  namespace: azureserviceoperator-system
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;spec:
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;  azureIdentity: aso-identity
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;  selector: aso-manager-binding
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;EOF&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Create the &lt;code&gt;aso-credential&lt;/code&gt; secret in your namespace:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;cat &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;lt;&amp;lt;EOF | kubectl apply -f -
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;apiVersion: v1
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;kind: Secret
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;metadata:
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt; name: aso-credential
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt; namespace: my-namespace
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;stringData:
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt; AZURE_SUBSCRIPTION_ID: &amp;#34;$AZURE_SUBSCRIPTION_ID&amp;#34;
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt; AZURE_TENANT_ID:       &amp;#34;$AZURE_TENANT_ID&amp;#34;
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt; AZURE_CLIENT_ID:       &amp;#34;$IDENTITY_CLIENT_ID&amp;#34;
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt; AUTH_MODE:             &amp;#34;podidentity&amp;#34;
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;EOF&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
    &lt;/div&gt;
    &lt;div class=&#34;tab-body tab-pane fade&#34;
        id=&#34;tabs-06-03&#34; role=&#34;tabpanel&#34; aria-labelled-by=&#34;tabs-06-03-tab&#34;&gt;
        &lt;p&gt;Deploy an &lt;code&gt;AzureIdentity&lt;/code&gt;:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;cat &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;lt;&amp;lt;EOF | kubectl apply -f -
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;apiVersion: &amp;#34;aadpodidentity.k8s.io/v1&amp;#34;
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;kind: AzureIdentity
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;metadata:
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;  name: aso-identity
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;  namespace: azureserviceoperator-system
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;spec:
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;  type: 0
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;  resourceID: ${IDENTITY_RESOURCE_ID}
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;  clientID: ${IDENTITY_CLIENT_ID}
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;EOF&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Deploy an &lt;code&gt;AzureIdentityBinding&lt;/code&gt; to bind this identity to the Azure Service Operator manager pod:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;cat &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;lt;&amp;lt;EOF | kubectl apply -f -
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;apiVersion: &amp;#34;aadpodidentity.k8s.io/v1&amp;#34;
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;kind: AzureIdentityBinding
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;metadata:
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;  name: aso-identity-binding
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;  namespace: azureserviceoperator-system
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;spec:
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;  azureIdentity: aso-identity
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;  selector: aso-manager-binding
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;EOF&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Create a per-resource secret. We&amp;rsquo;ll use &lt;code&gt;my-resource-secret&lt;/code&gt;:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;cat &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;lt;&amp;lt;EOF | kubectl apply -f -
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;apiVersion: v1
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;kind: Secret
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;metadata:
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt; name: my-resource-secret
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt; namespace: my-namespace
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;stringData:
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt; AZURE_SUBSCRIPTION_ID: &amp;#34;$AZURE_SUBSCRIPTION_ID&amp;#34;
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt; AZURE_TENANT_ID:       &amp;#34;$AZURE_TENANT_ID&amp;#34;
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt; AZURE_CLIENT_ID:       &amp;#34;$IDENTITY_CLIENT_ID&amp;#34;
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt; AUTH_MODE:             &amp;#34;podidentity&amp;#34;
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;EOF&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Create the ASO resource referring to &lt;code&gt;my-resource-secret&lt;/code&gt;. We show a &lt;code&gt;ResourceGroup&lt;/code&gt; here, but any ASO resource will work.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;cat &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;lt;&amp;lt;EOF | kubectl apply -f -
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;apiVersion: resources.azure.com/v1api20200601
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;kind: ResourceGroup
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;metadata:
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;  name: aso-sample-rg
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;  namespace: default
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;  annotations:
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;    serviceoperator.azure.com/credential-from: my-resource-secret
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;spec:
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;  location: westcentralus
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;EOF&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
    &lt;/div&gt;
&lt;/div&gt;


      </description>
    </item>
    
    <item>
      <title>Guide: Credential Scope</title>
      <link>https://azure.github.io/azure-service-operator/guide/authentication/credential-scope/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://azure.github.io/azure-service-operator/guide/authentication/credential-scope/</guid>
      <description>
        
        
        &lt;p&gt;When presented with multiple credential choices, the operator chooses the most specific one:
&lt;em&gt;resource scope&lt;/em&gt; takes precedence over &lt;em&gt;namespace scope&lt;/em&gt; which takes precedence over &lt;em&gt;global scope&lt;/em&gt;.&lt;/p&gt;
&lt;h2 id=&#34;global-scope&#34;&gt;Global scope&lt;/h2&gt;


&lt;div class=&#34;alert alert-warning&#34; role=&#34;alert&#34;&gt;
&lt;h4 class=&#34;alert-heading&#34;&gt;Warning&lt;/h4&gt;

    Be careful when using the global scope credential. A user in any namespace in your cluster will have the ability
to do everything that the global credential can do. For security best practice we recommend using namespace scoped
or resource scoped credentials. See &lt;a href=&#34;https://azure.github.io/azure-service-operator/azure-service-operator/guide/best-practices/security/&#34;&gt;security best practices&lt;/a&gt; for more details.

&lt;/div&gt;

&lt;p&gt;The global credential resides in the &lt;code&gt;aso-controller-settings&lt;/code&gt; secret deployed as part of operator deployment in
operator&amp;rsquo;s namespace.
This is the scope configured when configuring credentials via the Helm chart installation.&lt;/p&gt;
&lt;p&gt;When updating the &lt;code&gt;aso-controller-settings&lt;/code&gt; secret, you must restart the operator pod for the updated secret to
take effect.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;Note&lt;/strong&gt;: The &lt;code&gt;aso-controller-settings&lt;/code&gt; secret must exist, but the actual global credential portion of the secret
&lt;strong&gt;is optional&lt;/strong&gt;. If you do not wish to use a global credential, you must still provide the secret with empty values
for the &lt;code&gt;AZURE_SUBSCRIPTION_ID&lt;/code&gt;, and &lt;code&gt;AZURE_CLIENT_ID&lt;/code&gt;, and &lt;code&gt;AZURE_TENANT_ID&lt;/code&gt; strings.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&#34;namespace-scope&#34;&gt;Namespace scope&lt;/h2&gt;
&lt;p&gt;A secret named &lt;code&gt;aso-credential&lt;/code&gt; in a Kubernetes namespace configures the credential for all resources in that namespace,
overriding the global credential. This credential can be in a different tenant or subscription than the global credential.&lt;/p&gt;
&lt;h2 id=&#34;resource-scope&#34;&gt;Resource scope&lt;/h2&gt;
&lt;p&gt;A secret with any name can be referenced by the &lt;code&gt;serviceoperator.azure.com/credential-from&lt;/code&gt; annotation.
Create this annotation on each resource to configure the credential used for that resource.
The secret containing the credential must be in the same Kubernetes namespace as the resource but may be in a different
tenant or subscription than both the global credential and per-namespace credential.&lt;/p&gt;
&lt;p&gt;Note that multiple resources may refer to the same secret.&lt;/p&gt;

      </description>
    </item>
    
    <item>
      <title>Guide: Deploying Azure Service Operator v2 in multi-tenant mode</title>
      <link>https://azure.github.io/azure-service-operator/guide/authentication/multitenant-deployment/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://azure.github.io/azure-service-operator/guide/authentication/multitenant-deployment/</guid>
      <description>
        
        
        &lt;h2 id=&#34;multiple-operator-multitenancy&#34;&gt;Multiple operator multitenancy&lt;/h2&gt;
&lt;p&gt;Multiple operators deployed in different namespaces requires one deployment to handle webhooks (required because webhook configurations are cluster-level resources) and then a separate deployment for each tenant, each with its own credentials and set of namespaces that it watches for Azure resources.&lt;/p&gt;
&lt;p&gt;ASO may also be deployed in a &lt;em&gt;multi-tenant&lt;/em&gt; configuration, enabling the use of separate credentials for managing resources in different Kubernetes namespaces.&lt;/p&gt;
&lt;h3 id=&#34;multiple-operator-multitenancy-deployment&#34;&gt;Multiple operator multitenancy deployment&lt;/h3&gt;
&lt;p&gt;To deploy the operator in multi-operator multi-tenant mode the release YAML/helm installation has been split into two parts:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Cluster-wide resources&lt;/strong&gt;:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Custom resource definitions for the Azure resources.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Cluster roles for managing those resources.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;The &lt;code&gt;azureserviceoperator-system&lt;/code&gt; namespace containing the deployment and service to handle ASO webhooks.
The webhook service is a deployment of the ASO image, but configured to run in webhook-only mode.
It won&amp;rsquo;t try to reconcile Azure resources with ARM, and so doesn&amp;rsquo;t need any Azure credentials.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Webhook configuration referring to that service.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Per-tenant resources&lt;/strong&gt;:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;A namespace containing the deployment to run the tenant operator, configured for watchers-only mode.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;The &lt;code&gt;aso-controller-settings&lt;/code&gt; secret defining the Azure credentials that should be used, and the set of namespaces that this operator will watch for Azure resources.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;A cluster role binding enabling the per-tenant operator&amp;rsquo;s service account to manage the Azure resources.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;yaml-installation&#34;&gt;YAML Installation&lt;/h3&gt;
&lt;p&gt;Examples of the deployment YAML files are available on the release page for ASO v2 releases from &lt;a href=&#34;https://github.com/Azure/azure-service-operator/releases/tag/v2.0.0-beta.0&#34;&gt;v2.0.0-beta.0&lt;/a&gt;.
The cluster-wide file &lt;code&gt;multitenant-cluster_v2.0.0-beta.0.yaml&lt;/code&gt; can be used as-is (the webhook deployment namespace is fixed as &lt;code&gt;azureserviceoperator-system&lt;/code&gt;),
but the namespaces and cluster role binding in the per-tenant file &lt;code&gt;multitenant-tenant_v2.0.0-beta.0.yaml&lt;/code&gt; will need to be customised in each tenant&amp;rsquo;s YAML file from &lt;code&gt;tenant1&lt;/code&gt; to the desired name for that tenant.&lt;/p&gt;
&lt;h4 id=&#34;per-tenant-configuration&#34;&gt;Per-tenant configuration&lt;/h4&gt;
&lt;p&gt;Create the &lt;code&gt;aso-controller-settings&lt;/code&gt; secret as described in the &lt;a href=&#34;https://azure.github.io/azure-service-operator/azure-service-operator/guide/authentication/credential-format/&#34;&gt;authentication docs&lt;/a&gt;,
but create the secret in the tenant namespace and add an extra target namespaces key to it:&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;   export TENANT_NAMESPACE=&amp;quot;&amp;lt;tenant namespace&amp;gt;&amp;quot;
   export AZURE_SUBSCRIPTION_ID=&amp;quot;&amp;lt;subscription id&amp;gt;&amp;quot;
   export AZURE_TENANT_ID=&amp;quot;&amp;lt;tenant id&amp;gt;&amp;quot;
   export AZURE_CLIENT_ID=&amp;quot;&amp;lt;client id&amp;gt;&amp;quot;
   export AZURE_CLIENT_SECRET=&amp;quot;&amp;lt;client secret&amp;gt;&amp;quot;
   export AZURE_TARGET_NAMESPACES=&amp;quot;&amp;lt;comma-separated namespace names&amp;gt;&amp;quot;
   kubectl create namespace &amp;quot;$TENANT_NAMESPACE&amp;quot;
   cat &amp;lt;&amp;lt;EOF | kubectl apply -f -
   apiVersion: v1
   kind: Secret
   metadata:
     name: aso-controller-settings
     namespace: $TENANT_NAMESPACE
   stringData:
     AZURE_SUBSCRIPTION_ID: &amp;quot;$AZURE_SUBSCRIPTION_ID&amp;quot;
     AZURE_TENANT_ID: &amp;quot;$AZURE_TENANT_ID&amp;quot;
     AZURE_CLIENT_ID: &amp;quot;$AZURE_CLIENT_ID&amp;quot;
     AZURE_CLIENT_SECRET: &amp;quot;$AZURE_CLIENT_SECRET&amp;quot;
     AZURE_TARGET_NAMESPACES: &amp;quot;$AZURE_TARGET_NAMESPACES&amp;quot;
     EOF
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Once the tenant operator is deployed and configured the contents of the tenant namespace will look something like the following:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-sh&#34; data-lang=&#34;sh&#34;&gt;$ kubectl get pods,replicasets,deployments,serviceaccounts,secrets  -n tenant1-system
NAME                                                           READY   STATUS    RESTARTS   AGE
pod/azureserviceoperator-controller-manager-657948696b-dzfmw   1/1     Running   &lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;          3d

NAME                                                                 DESIRED   CURRENT   READY   AGE
replicaset.apps/azureserviceoperator-controller-manager-657948696b   &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;         &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;         &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;       3d

NAME                                                      READY   UP-TO-DATE   AVAILABLE   AGE
deployment.apps/azureserviceoperator-controller-manager   1/1     &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;            &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;           3d

NAME                     SECRETS   AGE
serviceaccount/default   &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;         3d

NAME                             TYPE                                  DATA   AGE
secret/aso-controller-settings   Opaque                                &lt;span style=&#34;color:#ae81ff&#34;&gt;5&lt;/span&gt;      3d
secret/default-token-mqmpb       kubernetes.io/service-account-token   &lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;      3d
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;helm-installation&#34;&gt;Helm Installation&lt;/h3&gt;
&lt;p&gt;To deploy the operator in multi-operator multi-tenant using helm is split into two parts:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Cluster-wide operator installation&lt;/strong&gt;:&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;helm repo add aso2 https://raw.githubusercontent.com/Azure/azure-service-operator/main/v2/charts
&lt;/code&gt;&lt;/pre&gt;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;helm upgrade --install --devel aso2 aso2/azure-service-operator \
   --create-namespace \
   --namespace=azureserviceoperator-system \
   --set multitenant.enable=true \
   --set azureOperatorMode=webhooks \
   --set crdPattern=&#39;resources.azure.com/*;containerservice.azure.com/*;keyvault.azure.com/*;managedidentity.azure.com/*;eventhub.azure.com/*&#39;
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Per-tenant operator installation&lt;/strong&gt;:&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;helm repo add aso2 https://raw.githubusercontent.com/Azure/azure-service-operator/main/v2/charts
&lt;/code&gt;&lt;/pre&gt;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;helm upgrade --install --devel aso2 aso2/azure-service-operator \
   --create-namespace \
   --namespace=tenant1-system \
   --set azureSubscriptionID=$AZURE_SUBSCRIPTION_ID \
   --set azureTenantID=$AZURE_TENANT_ID \
   --set azureClientID=$AZURE_CLIENT_ID \
   --set azureClientSecret=$AZURE_CLIENT_SECRET \
   --set multitenant.enable=true \
   --set azureTargetNamespaces=&#39;{ns1,ns2,ns3}&#39; \
   --set azureOperatorMode=watchers
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;role-handling&#34;&gt;Role handling&lt;/h3&gt;
&lt;p&gt;The multi-tenant deployment example files have a single &lt;code&gt;ClusterRole&lt;/code&gt; that grants access to the Azure resource types,
and then a binding to that &lt;code&gt;ClusterRole&lt;/code&gt; for the service account in each tenant-operator namespace.
Each &lt;code&gt;ClusterRoleBinding&lt;/code&gt; is named for the specific tenant, so they don&amp;rsquo;t collide and can be managed separately:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;../multitenant-simple-roles.png&#34; alt=&#34;diagram showing cluster-level role bindings pointing to tenant namespace service accounts&#34;&gt;&lt;/p&gt;
&lt;p&gt;This is convenient since there&amp;rsquo;s no need to permit access for Azure resources in each of the target namespaces individually,
but it means that the only thing preventing one tenant operator from reading another&amp;rsquo;s resources is the &lt;code&gt;AZURE_TARGET_NAMESPACES&lt;/code&gt; setting for each operator.&lt;/p&gt;
&lt;p&gt;For some usage scenarios that might be too permissive.&lt;/p&gt;
&lt;p&gt;In those cases the &lt;code&gt;azureserviceoperator-manager-role&lt;/code&gt; should be changed from a &lt;code&gt;ClusterRole&lt;/code&gt; into &lt;code&gt;Role&lt;/code&gt;s in each of the target namespaces (where the Azure resources will be created, rather than where the tenant-operator pods run),
and a &lt;code&gt;RoleBinding&lt;/code&gt; should be created in that namespace linking the &lt;code&gt;Role&lt;/code&gt; to the service account for the tenant operator that will be managing Azure resources in this target namespace:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;../multitenant-restrictive-roles.png&#34; alt=&#34;diagram showing namespace-scoped roles and bindings pointing to tenant operator service accounts&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;upgrading&#34;&gt;Upgrading&lt;/h3&gt;
&lt;p&gt;When upgrading to a newer version of ASO the cluster-wide resources (CRDs, cluster roles) and the webhook deployment must be upgraded before upgrading the tenant operators.&lt;/p&gt;
&lt;p&gt;Applying the new version of the &lt;code&gt;multitenant-cluster&lt;/code&gt; YAML file will add new and updated CRDs, then update the webhook configuration and cluster roles.
After that the new version of the &lt;code&gt;multitenant-tenant&lt;/code&gt; YAML files (customised for the specific tenant names) can be applied.&lt;/p&gt;

      </description>
    </item>
    
    <item>
      <title>Guide: Reducing Access</title>
      <link>https://azure.github.io/azure-service-operator/guide/authentication/reducing-access/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://azure.github.io/azure-service-operator/guide/authentication/reducing-access/</guid>
      <description>
        
        
        &lt;h2 id=&#34;using-a-credential-for-aso-with-reduced-permissions&#34;&gt;Using a credential for ASO with reduced permissions&lt;/h2&gt;
&lt;p&gt;Most examples of installing ASO suggest using an identity that has Contributor access to the Subscription.
Such broadly scoped access is &lt;em&gt;&lt;strong&gt;not&lt;/strong&gt;&lt;/em&gt; required to run the operator, it&amp;rsquo;s just the easiest way to set things up and so
is often used in examples.&lt;/p&gt;
&lt;p&gt;Here we discuss a few approaches to restricting the access that the ASO identity has.&lt;/p&gt;
&lt;h3 id=&#34;contributor-access-at-a-reduced-scope&#34;&gt;Contributor access at a reduced scope&lt;/h3&gt;
&lt;p&gt;In some scenarios you may know that ASO will be operating on only certain resource groups. For example, if you have two
teams working in a cluster with ASO, &amp;ldquo;Marketing&amp;rdquo; and &amp;ldquo;Product&amp;rdquo;. If you know ahead of time that the only resource groups these
teams will use are &lt;code&gt;marketing-dev&lt;/code&gt;, &lt;code&gt;marketing-prod&lt;/code&gt;, &lt;code&gt;product-dev&lt;/code&gt; and &lt;code&gt;product-prod&lt;/code&gt;, you can pre-create the following resources:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;The 4 resource groups.&lt;/li&gt;
&lt;li&gt;An identity for use by ASO, assigned Contributor permission to each of the 4 resource groups.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Now install ASO following the instructions above. Once ASO is installed, adopt the existing resource groups in ASO by applying a YAML in the cluster
for each of the 4 resource groups. Now users of ASO are free to create resources in those resource groups as normal. If they attempt
to use ASO to create a new resource group &lt;code&gt;foo&lt;/code&gt; they will be rejected by Azure as the ASO identity doesn&amp;rsquo;t have permission to create
arbitrary resource groups in the Subscription.&lt;/p&gt;
&lt;h3 id=&#34;reduced-access-at-subscription-scope&#34;&gt;Reduced access at Subscription scope&lt;/h3&gt;
&lt;p&gt;In other scenarios, you may want to give out reduced access at the Subscription scope. This can be done by determining what resources
in ASO you will be using and creating a custom role scoped to just those permissions.&lt;/p&gt;
&lt;p&gt;For example if you want to use ASO to manage ResourceGroups, Redis and MySQL flexible servers, but &lt;em&gt;not&lt;/em&gt; anything else, you could
&lt;a href=&#34;https://learn.microsoft.com/azure/role-based-access-control/custom-roles-cli&#34;&gt;create a role&lt;/a&gt; similar to &lt;code&gt;aso-operator.json&lt;/code&gt;:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-json&#34; data-lang=&#34;json&#34;&gt;{
  &lt;span style=&#34;color:#f92672&#34;&gt;&amp;#34;Name&amp;#34;&lt;/span&gt;: &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;ASO Operator&amp;#34;&lt;/span&gt;,
  &lt;span style=&#34;color:#f92672&#34;&gt;&amp;#34;IsCustom&amp;#34;&lt;/span&gt;: &lt;span style=&#34;color:#66d9ef&#34;&gt;true&lt;/span&gt;,
  &lt;span style=&#34;color:#f92672&#34;&gt;&amp;#34;Description&amp;#34;&lt;/span&gt;: &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Role with access to perform only the operations which we allow ASO to perform&amp;#34;&lt;/span&gt;,
  &lt;span style=&#34;color:#f92672&#34;&gt;&amp;#34;Actions&amp;#34;&lt;/span&gt;: [
    &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Microsoft.Resources/subscriptions/resourceGroups/*&amp;#34;&lt;/span&gt;,
    &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Microsoft.Cache/*&amp;#34;&lt;/span&gt;,
    &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Microsoft.DBforMySQL/*&amp;#34;&lt;/span&gt;
  ],
  &lt;span style=&#34;color:#f92672&#34;&gt;&amp;#34;NotActions&amp;#34;&lt;/span&gt;: [
  ],
  &lt;span style=&#34;color:#f92672&#34;&gt;&amp;#34;AssignableScopes&amp;#34;&lt;/span&gt;: [
    &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;/subscriptions/{subscriptionId1}&amp;#34;&lt;/span&gt;,
    &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;/subscriptions/{subscriptionId2}&amp;#34;&lt;/span&gt;
  ]
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Then use the az cli to create that custom role definition: &lt;code&gt;az role definition create --role-definition ~/aso-operator.json&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;See &lt;a href=&#34;https://learn.microsoft.com/en-us/azure/role-based-access-control/resource-provider-operations&#34;&gt;list of resource provider operations&lt;/a&gt; for a comprehensive
list of operations.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Note: We strongly recommend giving full permissions to the resource types ASO will be managing.&lt;/strong&gt; ASO needs &lt;code&gt;read&lt;/code&gt;, &lt;code&gt;write&lt;/code&gt;, and &lt;code&gt;delete&lt;/code&gt; permissions to a resource
to fully manage it. In some cases, it also needs &lt;code&gt;action&lt;/code&gt; permissions. It&amp;rsquo;s recommended to give &lt;code&gt;*&lt;/code&gt; permissions for a given resource type which ASO
will be managing.&lt;/p&gt;
&lt;p&gt;Once the role has been created, assign it to the ASO identity and install the operator as normal. It will be able to
manage any resource of the types you allowed. Any other resources will fail to be created/updated/deleted with a permissions error.&lt;/p&gt;

      </description>
    </item>
    
  </channel>
</rss>
